<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.6"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>Vargas</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand">Vargas 1.0 <a class="navbar-brand"
                                                                   href="https://github.com/RaviGaddipati/vargas"><font
                    size="1">Github</font></a></a>
        </div>
    </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Vargas</b></li><li class="navelem"><a class="el" href="classVargas_1_1Aligner.html">Aligner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="classVargas_1_1Aligner-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Vargas::Aligner&lt; num_reads, CellType, NativeT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="alignment_8h_source.html">alignment.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt;<br/>
class Vargas::Aligner&lt; num_reads, CellType, NativeT &gt;</h3>

<p>Main SIMD SW <a class="el" href="classVargas_1_1Aligner.html" title="Main SIMD SW Aligner. ">Aligner</a>. </p>
<p>Aligns a read batch to a reference sequence. Note: "score" means something that is added, "penalty" refers to something that is subtracted. All scores/penalties are provided as positive integers. Most memory is allocated for the class so it can be reused during alignment. To reduce memory usage, the maximum node size can be reduced. <br/>
Usage:<br/>
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="graph_8h.html">graph.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="alignment_8h.html">alignment.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classVargas_1_1GraphBuilder.html">Vargas::GraphBuilder</a> gb(<span class="stringliteral">&quot;reference.fa&quot;</span>, <span class="stringliteral">&quot;var.bcf&quot;</span>);</div>
<div class="line">gb.node_len(5);</div>
<div class="line">gb.ingroup(100);</div>
<div class="line">gb.region(<span class="stringliteral">&quot;x:0-15&quot;</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="classVargas_1_1Graph.html">Vargas::Graph</a> g = gb.build();</div>
<div class="line">std::vector&lt;std::string&gt; reads = {<span class="stringliteral">&quot;ACGT&quot;</span>, <span class="stringliteral">&quot;GGGG&quot;</span>, <span class="stringliteral">&quot;ATTA&quot;</span>, <span class="stringliteral">&quot;CCNT&quot;</span>};</div>
<div class="line"></div>
<div class="line"><a class="code" href="classVargas_1_1Aligner.html">Vargas::Aligner&lt;&gt;</a> a(g.<a class="code" href="classVargas_1_1Graph.html#aca064e40fe6e7cba83c0877f0aa5d89a">max_node_len</a>(), 4);</div>
<div class="line"><a class="code" href="structVargas_1_1Aligner_1_1Results.html">Vargas::Aligner&lt;&gt;::Results</a> res = a.align(reads, g.<a class="code" href="classVargas_1_1Graph.html#a4d991b791ab8bd96a0cf8c436424b759">begin</a>(), g.<a class="code" href="classVargas_1_1Graph.html#a57e76545e4fcccb5a430ed4cd046a77e">end</a>());</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; reads.size(); ++i) {</div>
<div class="line">   std::cout &lt;&lt; reads[i] &lt;&lt; <span class="stringliteral">&quot;, score:&quot;</span> &lt;&lt; res.max_score[i] &lt;&lt; <span class="stringliteral">&quot; pos:&quot;</span> &lt;&lt; res.max_pos[i] &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"><span class="comment">// Output:</span></div>
<div class="line"><span class="comment">// ACGT, score:8 pos:10</span></div>
<div class="line"><span class="comment">// GGGG, score:6 pos:65</span></div>
<div class="line"><span class="comment">// ATTA, score:8 pos:18</span></div>
<div class="line"><span class="comment">// CCNT, score:8 pos:80</span></div>
</div><!-- fragment --><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">num_reads</td><td>max number of reads. If a non-default T is used, this should be set to SIMDPP_FAST_T_SIZE where T corresponds to the width of T. For ex. Default T=simdpp::uint8 uses SIMDPP_FAST_INT8_SIZE </td></tr>
    <tr><td class="paramname">CellType</td><td>element type. Determines max score range. Default simdpp::uint8. </td></tr>
    <tr><td class="paramname">NativeT</td><td>Native version of CellType. Default uint8_t. </td></tr>
  </table>
  </dd>
</dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVargas_1_1Aligner_1_1AlignmentGroup.html">AlignmentGroup</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for a packaged batch of reads.  <a href="classVargas_1_1Aligner_1_1AlignmentGroup.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVargas_1_1Aligner_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct to return the alignment results.  <a href="structVargas_1_1Aligner_1_1Results.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab39351cc5dac9fb5097b77ae0bbde421"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVargas_1_1Aligner.html">Vargas::Aligner</a>&lt; num_reads, CellType, NativeT &gt;::<a class="el" href="classVargas_1_1Aligner.html">Aligner</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_node_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor uses the following score values: <br/>
Match : 2 <br/>
Mismatch : -2 <br/>
Gap Open : 3 <br/>
Gap Extend : 1 <br/>
. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_node_len</td><td>maximum node length </td></tr>
    <tr><td class="paramname">rlen</td><td>maximum read length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aca2b137c006484bed62e8981cb7a4f7b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVargas_1_1Aligner.html">Vargas::Aligner</a>&lt; num_reads, CellType, NativeT &gt;::<a class="el" href="classVargas_1_1Aligner.html">Aligner</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_node_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mismatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>open</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>extend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set scoring parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_node_len</td><td>max node length </td></tr>
    <tr><td class="paramname">rlen</td><td>max read length </td></tr>
    <tr><td class="paramname">match</td><td>match score </td></tr>
    <tr><td class="paramname">mismatch</td><td>mismatch penalty </td></tr>
    <tr><td class="paramname">open</td><td>gap open penalty </td></tr>
    <tr><td class="paramname">extend</td><td>gap extend penalty </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4d46d8ca13288b6e3c37e3d805733f51"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structVargas_1_1Aligner_1_1Results.html">Results</a> <a class="el" href="classVargas_1_1Aligner.html">Vargas::Aligner</a>&lt; num_reads, CellType, NativeT &gt;::align </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>read_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVargas_1_1Graph_1_1FilteringIter.html">Graph::FilteringIter</a>&#160;</td>
          <td class="paramname"><em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVargas_1_1Graph_1_1FilteringIter.html">Graph::FilteringIter</a>&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Align a batch of reads to a graph range, return a vector of alignments corresponding to the reads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">read_group</td><td>vector of reads to align to </td></tr>
    <tr><td class="paramname">begin</td><td>iterator to beginning of graph </td></tr>
    <tr><td class="paramname">end</td><td>iterator to end of graph </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structVargas_1_1Aligner_1_1Results.html" title="Struct to return the alignment results. ">Results</a> packet </dd></dl>

</div>
</div>
<a class="anchor" id="a3edcb6302d16de79f9b575ce55f26ae1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classVargas_1_1Aligner.html">Vargas::Aligner</a>&lt; num_reads, CellType, NativeT &gt;::align_into </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>read_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVargas_1_1Graph_1_1FilteringIter.html">Graph::FilteringIter</a>&#160;</td>
          <td class="paramname"><em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVargas_1_1Graph_1_1FilteringIter.html">Graph::FilteringIter</a>&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVargas_1_1Aligner_1_1Results.html">Results</a> &amp;&#160;</td>
          <td class="paramname"><em>aligns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Align a batch of reads to a graph range, return a vector of alignments corresponding to the reads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">read_group</td><td>vector of reads to align to </td></tr>
    <tr><td class="paramname">targets</td><td>correct positions for reads in read_group </td></tr>
    <tr><td class="paramname">begin</td><td>iterator to beginning of graph </td></tr>
    <tr><td class="paramname">end</td><td>iterator to end of graph </td></tr>
    <tr><td class="paramname">aligns</td><td><a class="el" href="structVargas_1_1Aligner_1_1Results.html" title="Struct to return the alignment results. ">Results</a> packet to populate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa4604b5e0fa1aa0aa8b6c2770af38afd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int num_reads = SIMDPP_FAST_INT8_SIZE, template&lt; unsigned int, typename=void &gt; class CellType = simdpp::uint8, typename NativeT = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classVargas_1_1Aligner.html">Vargas::Aligner</a>&lt; num_reads, CellType, NativeT &gt;::set_scores </td>
          <td>(</td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>mismatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>open</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>extend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the scoring scheme used for the alignments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">match</td><td>match score </td></tr>
    <tr><td class="paramname">mismatch</td><td>mismatch score </td></tr>
    <tr><td class="paramname">open</td><td>gap open penalty </td></tr>
    <tr><td class="paramname">extend</td><td>gap extend penalty </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="alignment_8h_source.html">alignment.h</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
<address class="footer">
    <center>
        Ravi Gaddipati. <a href="mailto:rgaddip1@jhu.edu"> rgaddip1@jhu.edu</a>
    </center>
    <small>
        <a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
        </a>
    </small>
</address>
</body>
</html>
